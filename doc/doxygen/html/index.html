<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Communication Library for Autonomous Systems: Communication Library for Autonomous Systems</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Communication Library for Autonomous Systems<span id="projectnumber">&#160;v1.0</span>
   </div>
   <div id="projectbrief">Reliable and secure communication library for autonomous vehicle systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('index.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Communication Library for Autonomous Systems </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__r_e_a_d_m_e"></a></p>
<p>This project implements a reliable and secure communication library for autonomous systems, focusing on the communication between vehicles and their components.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md1"></a>
Project Description</h1>
<p>The project follows the specifications provided by the Operating Systems II course, implementing:</p>
<ol type="1">
<li><b>Communication Stack</b>:<ul>
<li>Network Interface Card (NIC) simulation</li>
<li>Protocol layer for message routing</li>
<li>Communicator class for high-level message exchange</li>
</ul>
</li>
<li><b>Observer Pattern Implementation</b>:<ul>
<li>Dual observer pattern approach as specified by the professor</li>
<li>Conditional Observer pattern between NIC and Protocol for filtering</li>
<li>Concurrent Observer pattern between Protocol and Communicator for asynchronous communication</li>
</ul>
</li>
<li><b>Process Management</b>:<ul>
<li>Each vehicle runs in its own process</li>
<li>Initializer framework for managing vehicle lifecycle</li>
<li>Inter-process communication through the communication stack</li>
</ul>
</li>
<li><b>Vehicle Component Architecture</b>:<ul>
<li>Component base class for vehicle subsystems</li>
<li>Specialized components for various vehicle functions</li>
<li>Thread-safe communication between components</li>
</ul>
</li>
</ol>
<h1 class="doxsection"><a class="anchor" id="autotoc_md2"></a>
Project Structure</h1>
<div class="fragment"><div class="line">project-root/</div>
<div class="line">│── include/              # Header files</div>
<div class="line">│   ├── communicator.h    # High-level communication API</div>
<div class="line">│   ├── initializer.h     # Process management</div>
<div class="line">│   ├── nic.h             # Network interface implementation</div>
<div class="line">│   ├── observed.h        # Observer pattern implementation</div>
<div class="line">│   ├── observer.h        # Observer pattern implementation</div>
<div class="line">│   ├── protocol.h        # Communication protocol</div>
<div class="line">│   ├── vehicle.h         # Vehicle implementation</div>
<div class="line">│   ├── component.h       # Base class for vehicle components</div>
<div class="line">│   ├── address.h         # Address handling</div>
<div class="line">│   ├── ethernet.h        # Ethernet frame handling</div>
<div class="line">│   ├── socketEngine.h    # Raw socket communication</div>
<div class="line">│   ├── sharedMemoryEngine.h # Shared memory communication</div>
<div class="line">│   ├── message.h         # Message container</div>
<div class="line">│   ├── buffer.h          # Memory management</div>
<div class="line">│   ├── components/       # Specialized vehicle components</div>
<div class="line">│       ├── battery_component.h</div>
<div class="line">│       ├── camera_component.h</div>
<div class="line">│       ├── ecu_component.h</div>
<div class="line">│       ├── ins_component.h</div>
<div class="line">│       ├── lidar_component.h</div>
<div class="line">│── tests/                # Test implementations</div>
<div class="line">│   ├── unit_tests/       # Unit tests for individual components</div>
<div class="line">│   ├── integration_tests/ # Tests for component interactions</div>
<div class="line">│   ├── system_tests/     # Full system tests</div>
<div class="line">│── bin/                  # Compiled binaries</div>
<div class="line">│── build/                # Build artifacts</div>
<div class="line">│── doc/                  # Documentation</div>
<div class="line">│   ├── README.md         # System architecture overview</div>
<div class="line">│   ├── README_tests.md   # Testing framework documentation</div>
<div class="line">│   ├── classes/          # Component-specific documentation</div>
<div class="line">│       ├── README-Communicator.md</div>
<div class="line">│       ├── README-Initializer.md</div>
<div class="line">│       ├── README-Observer.md</div>
<div class="line">│       ├── README-Protocol.md</div>
<div class="line">│       ├── README-Nic.md</div>
<div class="line">│       ├── README-Ethernet.md</div>
<div class="line">│       ├── README-SocketEngine.md</div>
<div class="line">│       ├── README-SharedMemoryEngine.md</div>
<div class="line">│       ├── README-Message.md</div>
<div class="line">│       ├── README-Buffer.md</div>
<div class="line">│── logs/                 # Log output directory</div>
<div class="line">│── statistics/           # Performance metrics and statistics</div>
<div class="line">│── Makefile              # Build and test automation</div>
<div class="line">│── Dockerfile            # Container definition for testing</div>
<div class="line">│── README.md             # Project overview</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md3"></a>
Getting Started</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md4"></a>
Prerequisites</h2>
<ul>
<li>C++14 compatible compiler</li>
<li>POSIX-compatible environment</li>
<li>pthread library</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md5"></a>
Building and Running Tests</h2>
<div class="fragment"><div class="line"># Build and run tests</div>
<div class="line">make </div>
<div class="line"> </div>
<div class="line"># Clean build artifacts</div>
<div class="line">make clean</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md6"></a>
Demo Test Configuration</h2>
<p>The main demo test simulates a network of autonomous vehicles:</p><ul>
<li>Creates multiple vehicles running in separate processes</li>
<li>Each vehicle has various components (LiDAR, camera, ECU, etc.)</li>
<li>Components communicate with each other within and across vehicles</li>
<li>All log output is saved to the logs/ directory</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md7"></a>
System Architecture</h1>
<p>The complete system architecture and detailed component interactions are documented in doc/README.md. This document provides:</p>
<ul>
<li>A layered architecture diagram of the communication system</li>
<li>Explanation of the Observer pattern implementations</li>
<li>Detailed documentation for each component</li>
<li>Information about communication flow and message handling</li>
<li>Memory management and thread safety details</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
Component Architecture</h1>
<p>The component architecture consists of:</p>
<ol type="1">
<li><b>Base Component Class</b>:<ul>
<li>Thread-safe execution in dedicated threads</li>
<li>Standardized communication interface</li>
<li>Built-in logging and error handling</li>
</ul>
</li>
<li><b>Specialized Components</b>:<ul>
<li><b>LiDAR Component</b>: Generates and transmits point cloud data</li>
<li><b>Camera Component</b>: Simulates video frame capture and transmission</li>
<li><b>ECU Component</b>: Electronic Control Unit for vehicle management</li>
<li><b>INS Component</b>: Inertial Navigation System for position tracking</li>
<li><b>Battery Component</b>: Battery status monitoring and reporting</li>
</ul>
</li>
<li><b>Component Communication</b>:<ul>
<li>Direct component-to-component messaging</li>
<li>Support for broadcast communications</li>
<li>Addressing based on vehicle ID and component port</li>
</ul>
</li>
</ol>
<h1 class="doxsection"><a class="anchor" id="autotoc_md9"></a>
Documentation</h1>
<p>For detailed information about each component, please refer to the following documentation:</p>
<ul>
<li><b>doc/README.md</b>: Overview of the entire communication system architecture</li>
<li><b>doc/README_tests.md</b>: Details about the testing framework</li>
<li><b>doc/classes/README-Communicator.md</b>: Details of the Communicator class implementation</li>
<li><b>doc/classes/README-Initializer.md</b>: Process management and vehicle lifecycle</li>
<li><b>doc/classes/README-Observer.md</b>: Observer pattern implementation details</li>
<li><b>doc/classes/README-Protocol.md</b>: Communication protocol implementation</li>
<li><b>doc/classes/README-Nic.md</b>: Network interface card implementation</li>
<li><b>doc/classes/README-Ethernet.md</b>: Ethernet frame handling</li>
<li><b>doc/classes/README-SocketEngine.md</b>: Low-level network access with raw sockets</li>
<li><b>doc/classes/README-SharedMemoryEngine.md</b>: Shared memory communication engine</li>
<li><b>doc/classes/README-Message.md</b>: Message container implementation</li>
<li><b>doc/classes/README-Buffer.md</b>: Memory management for network data</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md10"></a>
Implementation Notes</h1>
<p>This project implements a dual observer pattern approach:</p>
<ol type="1">
<li><b>Conditional Observer Pattern</b>:<ul>
<li>Used between NIC and Protocol</li>
<li>Based on protocol numbers for filtering</li>
<li>No thread synchronization involved</li>
</ul>
</li>
<li><b>Concurrent Observer Pattern</b>:<ul>
<li>Used between Protocol and Communicator</li>
<li>Provides asynchronous message handling</li>
<li>Includes thread synchronization with semaphores</li>
</ul>
</li>
</ol>
<p>The implementation follows the professor's specifications, providing a robust foundation for communication between autonomous systems.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md11"></a>
Address Rule of Formation</h1>
<p>Each Communicator in the system is assigned a unique address that follows a hierarchical addressing scheme:</p>
<ol type="1">
<li><b>Physical Address Component (MAC Address)</b>:<ul>
<li>Each Communicator inherits the physical MAC address of the vehicle's NIC</li>
<li>MAC addresses are 6-byte (48-bit) identifiers defined in <span class="tt">Ethernet::Address</span></li>
</ul>
</li>
<li><b>Logical Address Component (Port Number)</b>:<ul>
<li>Each Communicator within a vehicle is assigned a unique port number</li>
<li>Port 0 is reserved for the vehicle itself</li>
<li>Components are assigned sequential ports (1, 2, 3, etc.)</li>
</ul>
</li>
<li><b>Vehicle MAC Address Formation</b>:<ul>
<li>Vehicle MAC addresses follow a specific format: <span class="tt">02:00:00:00:XX:YY</span></li>
<li>The first byte is always <span class="tt">0x02</span> to indicate a locally administered address</li>
<li>The last two bytes <span class="tt">XX:YY</span> represent the 16-bit vehicle ID</li>
<li>This design limits the system to a maximum of 65,536 (2^16) unique vehicles</li>
</ul>
</li>
<li><b>String Representation</b>:<ul>
<li>Addresses are formatted as <span class="tt">MAC:PORT</span></li>
<li>Example: <span class="tt">02:00:00:00:00:01:1</span> represents the component with port 1 on a vehicle with MAC address 02:00:00:00:00:01</li>
</ul>
</li>
</ol>
<p>This dual-layer addressing system ensures unique identification of each Communicator across the entire network.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md12"></a>
Multicast Capability</h1>
<p>The hierarchical addressing scheme supports potential implementation of multicast communication:</p>
<ol type="1">
<li><b>Component Groups</b>:<ul>
<li>Components can be logically grouped by assigning similar port patterns</li>
<li>For example, all sensor components could use ports 1xx, actuators 2xx, etc.</li>
</ul>
</li>
<li><b>Vehicle Groups</b>:<ul>
<li>Vehicles can be organized into functional groups using specific bits in their ID</li>
<li>Example: First 8 bits could represent the group, last 8 bits the vehicle within the group</li>
</ul>
</li>
<li><b>Multicast Implementation</b>:<ul>
<li>Protocol layer can be extended to recognize special address patterns for multicast</li>
<li>Messages could be sent to all components of a certain type across multiple vehicles</li>
<li>A multicast address could use reserved patterns (e.g., specific port ranges or MAC address bits)</li>
</ul>
</li>
</ol>
<p>This addressing structure provides the flexibility to implement efficient one-to-many communication patterns in future extensions.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md13"></a>
Illustration of the Encapsulation</h1>
<p><img src="./doc/img/encapsulation.png" alt="Encapsulation" class="inline"/></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md14"></a>
Clock Synchronization</h1>
<p>The system implements a high-precision PTP (Precision Time Protocol) clock synchronization mechanism designed for autonomous vehicle networks. The clock synchronization parameters have been carefully chosen based on precision requirements and hardware capabilities.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md15"></a>
Design Rationale</h2>
<h3 class="doxsection"><a class="anchor" id="autotoc_md16"></a>
<b>Precision Choice: Millisecond Resolution</b></h3>
<p>The system uses millisecond precision (<span class="tt">std::chrono::milliseconds</span>) for all timestamp operations:</p>
<ul>
<li><b>Message transmission time</b>: 2us per message</li>
<li><b>Hardware capability</b>: macOS M1 Pro reliably delivers millisecond precision</li>
<li><b>PTP requirements</b>: Millisecond precision suitable for many vehicular applications</li>
<li><b>Efficiency</b>: Good balance between precision and computational overhead</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md17"></a>
<b>Timeout Configuration: 20ms Leader Silence Interval</b></h3>
<p>The <span class="tt">MAX_LEADER_SILENCE_INTERVAL</span> is set to 20 milliseconds based on cumulative error analysis:</p>
<div class="fragment"><div class="line"><span class="comment">// Allow up to 10ms cumulative error:</span></div>
<div class="line"><span class="comment">// For standard crystal specification worst-case (~20 ppb): 10ms / 20ppb = 500ms</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">constexpr</span> <a class="code hl_typedef" href="clock_8h.html#ac9b36752fe8dc0a5e6a756cc671179c6">DurationType</a> MAX_LEADER_SILENCE_INTERVAL = std::chrono::milliseconds(500);</div>
<div class="ttc" id="aclock_8h_html_ac9b36752fe8dc0a5e6a756cc671179c6"><div class="ttname"><a href="clock_8h.html#ac9b36752fe8dc0a5e6a756cc671179c6">DurationType</a></div><div class="ttdeci">std::chrono::microseconds DurationType</div><div class="ttdef"><b>Definition</b> clock.h:19</div></div>
</div><!-- fragment --><p><b>Calculation methodology</b>:</p><ul>
<li><b>Cumulative error limit</b>: 10ms (10× the 1ms precision for safety margin)</li>
<li><b>Assumed oscillator drift</b>: 20 parts per billion (ppb) - standard crystal specification worst-case</li>
<li><b>Formula</b>: <span class="tt">MAX_SILENCE = ERROR_LIMIT / DRIFT_RATE = 10ms / 20ppb = 500ms</span></li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md18"></a>
<b>Hardware Requirements</b></h3>
<p>This configuration is based on standard crystal specifications:</p><ul>
<li><b>Standard Crystal Specification</b>: Maximum allowed long-term frequency drift of 20 ppb</li>
<li><b>Conservative approach</b>: Uses worst-case specification limits rather than typical performance</li>
<li><b>Real-world robustness</b>: Accounts for temperature variations, crystal aging, and manufacturing tolerances</li>
<li><b>Widely applicable</b>: Works with standard PC hardware and embedded systems</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md19"></a>
<b>Benefits of This Approach</b></h3>
<ol type="1">
<li><b>Specification-based</b>: Uses actual hardware specifications from standard crystal documentation</li>
<li><b>Conservative design</b>: Handles worst-case hardware performance scenarios</li>
<li><b>Fast failure detection</b>: 500ms timeout enables rapid leader failover</li>
<li><b>Robust operation</b>: Works reliably even with poor-quality or aged crystals</li>
</ol>
<h3 class="doxsection"><a class="anchor" id="autotoc_md20"></a>
<b>Performance Characteristics</b></h3>
<ul>
<li><b>Maximum drift error</b>: 10ms over 500ms silence period</li>
<li><b>Network tolerance</b>: Handles typical network jitter (usually &lt; 10ms)</li>
<li><b>Leader failover time</b>: Maximum 500ms detection of failed leaders</li>
<li><b>Message capacity</b>: ~250,000 messages possible during timeout period (500ms ÷ 2μs)</li>
</ul>
<p>This design ensures reliable clock synchronization while maintaining the precision required for safety-critical autonomous vehicle operations.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md21"></a>
Docker to use most recent gcc version</h1>
<div class="fragment"><div class="line">sudo docker build -t newestGCCenv .</div>
<div class="line">sudo docker run -it --rm --privileged -v &quot;$(pwd)&quot;:/app newestGCCenv</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md22"></a>
📖 Documentation</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md23"></a>
Online Documentation (GitHub Pages)</h2>
<p>The complete API documentation is automatically generated and hosted at: <b><a href="https://joaopedroschmidtcordeiro.github.io/UFSC-INE5424/">📚 https://joaopedroschmidtcordeiro.github.io/UFSC-INE5424/</a></b></p>
<p>The documentation includes:</p><ul>
<li>Complete API reference for all classes and functions</li>
<li>Class inheritance diagrams <br  />
</li>
<li>File dependency graphs</li>
<li>Cross-referenced source code</li>
<li>Integration with the project README as the main page</li>
</ul>
<p><em>Note: Documentation is automatically updated whenever code is pushed to the main branch.</em></p>
<p><b>📋 Want to set up GitHub Pages for your own project?</b> See our comprehensive setup guide: <span class="tt">docs-setup.md</span></p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md24"></a>
Local Documentation Generation</h2>
<p>You can also generate the documentation locally using Doxygen:</p>
<div class="fragment"><div class="line"># Generate HTML documentation</div>
<div class="line">make docs</div>
<div class="line"> </div>
<div class="line"># Generate and open documentation in browser</div>
<div class="line">make docs-open</div>
<div class="line"> </div>
<div class="line"># Clean generated documentation</div>
<div class="line">make clean-docs</div>
</div><!-- fragment --><p><b>Prerequisites for local documentation generation:</b></p><ul>
<li>Doxygen (install with <span class="tt">brew install doxygen</span> on macOS) </li>
</ul>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- Doxygen Footer -->
<hr class="footer"/>
<address class="footer">
  <small>
    Generated on Sun Jun 1 2025 21:50:35 for Communication Library for Autonomous Systems by <a href="https://www.doxygen.org/index.html">Doxygen</a> 1.14.0<br/>
    <a href="https://github.com/joaopedroschmidtcordeiro/UFSC-INE5424" target="_blank">
      📁 View Source Code on GitHub
    </a> |
    <a href="https://github.com/joaopedroschmidtcordeiro/UFSC-INE5424/issues" target="_blank">
      🐛 Report Issues
    </a> |
    <a href="https://github.com/joaopedroschmidtcordeiro/UFSC-INE5424/blob/main/README.md" target="_blank">
      📖 Project Documentation
    </a>
  </small>
</address>
</body>
</html> 
